rules:
  - id: xss-template
    message: Potential XSS â€” untrusted input flows into dangerous DOM sink.
    severity: WARNING
    metadata:
      category: security
      cwe: ['CWE-79']
      owasp: ['A03:2021 - Injection']
      impact: HIGH
    languages: [javascript, typescript]
    mode: taint
    pattern-sources:
      - pattern-either:
          - pattern: $SOURCE = document.getElementById($ID).value
          - pattern: $SOURCE = new URLSearchParams(location.search).get(...)
          - pattern: $SOURCE = window.location.hash
    pattern-sinks:
      - pattern-either:
          - pattern: $EL.innerHTML = $SOURCE
          - pattern: $EL.insertAdjacentHTML($POS, $SOURCE)
          - pattern: document.write($SOURCE)
    pattern-sanitizers:
      - pattern-either:
          - pattern: DOMPurify.sanitize($SOURCE)
