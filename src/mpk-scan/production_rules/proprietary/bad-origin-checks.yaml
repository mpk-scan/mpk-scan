rules:
- id: bad-origin-checks
  metadata:
    category: bad-origin-checks
    cwe: "CWE-346: Origin Validation Error"
    security: "high"
  languages: [javascript, typescript]
  severity: ERROR
  message: |
    ðŸš¨ Insecure origin check detected!
    - This allows an attacker to spoof an origin to pass the weak check
    - Use `if ($OBJ.origin === "https://trusted.com")` instead.
  pattern-either:
   - pattern-regex: \b(origin|url)\.includes\s*\(\s*["'][^"']+["']\s*\) # weak includes
   - pattern-regex: \b(origin|url)\.startsWith\s*\(\s*["'][^"']+["']\s*\) # weak starts with
   - pattern-regex: \b(origin|url)\.indexOf\s*\(\s*["'][^"']+["']\s*\) # weak index of
   - pattern-regex: \b(origin|url)\.endsWith\(["'][a-zA-Z0-9-]+\.[a-zA-Z0-9]+["']\) # weak ends with
